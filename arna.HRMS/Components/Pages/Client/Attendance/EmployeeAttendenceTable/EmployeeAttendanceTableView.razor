@using arna.HRMS.Components.lib.components.ui.Forms
@using arna.HRMS.Models.Common.Table
@using arna.HRMS.Models.ViewModels.Attendance

<div class="card border-0 shadow-sm rounded-3">

    <div class="card-header bg-white border-bottom py-2 py-md-3 px-2 px-md-3">
        <div class="d-flex align-items-center justify-content-between">
            <h6 class="fw-semibold mb-0 small">
                <i class="bi bi-table text-primary me-1 me-md-2"></i>
                <span class="d-none d-sm-inline">Daily Attendance Records</span>
                <span class="d-sm-none">Records</span>
            </h6>
            <span class="badge bg-primary bg-opacity-10 text-primary rounded-pill
                         px-2 px-md-3 small">
                @Attendance.Count
                <span class="d-none d-sm-inline">days</span>
            </span>
        </div>
    </div>

    <div class="card-body p-0">
        @if (!Attendance.Any())
        {
            <div class="text-center py-4 py-md-5 px-3">
                <div class="att-table-empty-icon bg-light rounded-circle d-inline-flex
                                align-items-center justify-content-center mb-2 mb-md-3">
                    <i class="bi bi-calendar-x fs-2 text-muted opacity-50"></i>
                </div>
                <h6 class="fw-semibold text-muted mb-1">No Records Found</h6>
                <p class="text-muted small mb-0 mx-auto att-table-empty-text">
                    No attendance records available for this period.
                </p>
            </div>
        }
        else
        {
            <div class="att-table-scroll">
                <AppTable TItem="MonthlyAttendanceViewModel"
                          Items="Attendance"
                          Columns="TableSchemas.EmployeeAttendence"
                          ShowActions="false"
                          EnablePagination="true"
                          PageSize="10"
                          WrapperClass="att-list-table"
                          RowClassFunc="GetRowClass" />
            </div>
        }
    </div>
</div>

@code {

    [Parameter, EditorRequired]
    public List<MonthlyAttendanceViewModel> Attendance { get; set; } = new();

    private static string GetRowClass(MonthlyAttendanceViewModel r)
    {
        if (r.Date.DayOfWeek is DayOfWeek.Saturday or DayOfWeek.Sunday)
            return "att-table-weekend";

        var status = r.Employees.FirstOrDefault()?.Status;
        return status switch
        {
            "Absent" => "att-table-absent",
            "Late" => "att-table-late",
            "Holiday" => "att-table-holiday",
            _ => ""
        };
    }
}